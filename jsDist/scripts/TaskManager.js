"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _lodash = _interopRequireDefault(require("lodash"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

// import WatchJS from 'watchjs';
//
// const { watch } = WatchJS;
var state = {
  activeList: {
    id: null,
    name: ''
  },
  activeTaskId: null,
  lists: [],
  tasks: []
};

var getElementsIn = function getElementsIn(type) {
  var isDone = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  var result = type === 'list' ? state.lists : state.tasks.filter(function (task) {
    return task.parentList === state.activeList.name && task.isDone === isDone;
  });
  return result;
};

var getElementById = function getElementById(id) {
  var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'task';
  return [].concat(_toConsumableArray(getElementsIn(type)), _toConsumableArray(getElementsIn(type, true))).find(function (task) {
    return task.id === id;
  });
};

var getPosition = function getPosition(type) {
  var isDone = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
  return getElementsIn(type, isDone).length;
};

var sortByPosition = function sortByPosition(a, b) {
  return a.position - b.position;
};

var sortPositionsAfterRemove = function sortPositionsAfterRemove(type, isDone) {
  var sortGroup = getElementsIn(type, isDone);
  sortGroup.sort(sortByPosition).reduce(function (accIndex, el) {
    el.position = accIndex;
    return accIndex + 1;
  }, 0);
};

var eventFunctions = {
  lists: {
    select: function select(_ref) {
      var target = _ref.target;
      var _target$dataset = target.dataset,
          id = _target$dataset.id,
          name = _target$dataset.name;
      state.activeList = {
        id: id,
        name: name
      };
      state.render();
    }
  },
  buttons: {
    replace: function replace(_ref2) {
      var target = _ref2.target;
      var replaceType = target.dataset.buttonFunc;
      var _target$parentNode$da = target.parentNode.dataset,
          type = _target$parentNode$da.type,
          id = _target$parentNode$da.id;
      var upDownPos = replaceType === 'up' ? -1 : 1;
      var mainElement = getElementById(id, type);
      var secondaryElement = getElementsIn(type).find(function (task) {
        return task.position === mainElement.position + upDownPos;
      });
      console.log('replace', mainElement, secondaryElement, upDownPos, replaceType, type, id);
      if (!secondaryElement) return;
      mainElement.position += upDownPos;
      secondaryElement.position -= upDownPos;
      state.render();
    },
    startOutOfTurn: function startOutOfTurn(_ref3) {
      var target = _ref3.target;
      var id = target.parentNode.dataset.id;
      state.activeTaskId = id;
      state.mainState.setDefault(false);
      state.render();
    },
    doneUndone: function doneUndone(_ref4) {
      var target = _ref4.target;
      var _target$parentNode$da2 = target.parentNode.dataset,
          type = _target$parentNode$da2.type,
          id = _target$parentNode$da2.id;
      var task = getElementById(id);
      task.isDone = !task.isDone;
      task.position = getPosition(type, task.isDone);
      sortPositionsAfterRemove(type, false);
      sortPositionsAfterRemove(type, true);
      state.render();
    },
    remove: function remove(_ref5) {
      var target = _ref5.target;
      var _target$parentNode$da3 = target.parentNode.dataset,
          type = _target$parentNode$da3.type,
          id = _target$parentNode$da3.id;
      var isDone = getElementById(id, type).isDone;
      var areaName = "".concat(type, "s");
      state[areaName] = state[areaName].filter(function (el) {
        return el.id !== id;
      });
      sortPositionsAfterRemove(type, isDone);
      state.render();
    }
  }
};

var getSelectedElementId = function getSelectedElementId() {
  if (state.activeTaskId !== null) return state.activeTaskId;
  var nextElement = getElementsIn('task').sort(sortByPosition)[0];
  return nextElement ? nextElement.id : null;
};

var selectButtons = {
  list: {
    removeAble: ['up', 'down', 'remove'],
    removeDisable: ['up', 'down']
  },
  task: ['up', 'down', 'startOutOfTurn', 'done', 'remove'],
  doneTask: ['undone', 'remove']
};

var render = function render(elements) {
  var ulForLists = document.createElement('ul');
  state.lists.sort(sortByPosition).forEach(function (_ref6) {
    var id = _ref6.id,
        name = _ref6.name,
        mutability = _ref6.mutability;
    var li = document.createElement('li');
    li.dataset.type = 'list';
    li.dataset.id = id;
    li.dataset.name = name;
    if (id === state.activeList.id) li.classList.add('selected');
    li.textContent = name;
    li.addEventListener('click', eventFunctions.lists.select);
    var liButtons = elements.buttons.filter(function (_ref7) {
      var type = _ref7.type;
      return selectButtons.list[mutability].includes(type);
    }).map(function (_ref8) {
      var button = _ref8.button;
      return button.cloneNode(true);
    }).map(function (button) {
      button.addEventListener('click', eventFunctions.buttons[button.dataset.buttonType]);
      return button;
    });
    li.append.apply(li, _toConsumableArray(liButtons));
    ulForLists.appendChild(li);
  });
  elements.lists.innerHTML = '';
  elements.lists.appendChild(ulForLists);
  var ulForTasks = document.createElement('ul');
  getElementsIn('task', false).sort(sortByPosition).forEach(function (_ref9) {
    var id = _ref9.id,
        name = _ref9.name;
    var li = document.createElement('li');
    li.dataset.id = id;
    if (id === getSelectedElementId()) li.classList.add('selected');
    li.textContent = name;
    li.dataset.type = 'task';
    var liButtons = elements.buttons.filter(function (_ref10) {
      var type = _ref10.type;
      return selectButtons.task.includes(type);
    }).map(function (_ref11) {
      var button = _ref11.button;
      return button.cloneNode(true);
    }).map(function (button) {
      button.addEventListener('click', eventFunctions.buttons[button.dataset.buttonType]);
      return button;
    });
    li.append.apply(li, _toConsumableArray(liButtons));
    ulForTasks.appendChild(li);
  });
  elements.tasks.innerHTML = '';
  elements.tasks.appendChild(ulForTasks);
  var ulForDoneTasks = document.createElement('ul');
  getElementsIn('task', true).sort(sortByPosition).forEach(function (_ref12) {
    var id = _ref12.id,
        name = _ref12.name;
    var li = document.createElement('li');
    li.dataset.id = id;
    li.textContent = name;
    li.dataset.type = 'doneTask';
    var liButtons = elements.buttons.filter(function (_ref13) {
      var type = _ref13.type;
      return selectButtons.doneTask.includes(type);
    }).map(function (_ref14) {
      var button = _ref14.button;
      return button.cloneNode(true);
    }).map(function (button) {
      button.addEventListener('click', eventFunctions.buttons[button.dataset.buttonType]);
      return button;
    });
    li.append.apply(li, _toConsumableArray(liButtons));
    ulForDoneTasks.appendChild(li);
  });
  elements.doneTasks.innerHTML = '';
  elements.doneTasks.appendChild(ulForDoneTasks);
  elements.listForm.reset();
  elements.taskForm.reset();
};

var init = function init(mainState) {
  var upButton = document.createElement('button');
  upButton.dataset.buttonType = 'replace';
  upButton.dataset.buttonFunc = 'up';
  upButton.textContent = 'up';
  var downButton = document.createElement('button');
  downButton.dataset.buttonType = 'replace';
  downButton.dataset.buttonFunc = 'down';
  downButton.textContent = 'down';
  var startOutOfTurnButton = document.createElement('button');
  startOutOfTurnButton.dataset.buttonType = 'startOutOfTurn';
  startOutOfTurnButton.textContent = 'start now';
  var doneButton = document.createElement('button');
  doneButton.dataset.buttonType = 'doneUndone';
  doneButton.textContent = 'done';
  var undoneButton = document.createElement('button');
  undoneButton.dataset.buttonType = 'doneUndone';
  undoneButton.textContent = 'undone';
  var removeButton = document.createElement('button');
  removeButton.dataset.buttonType = 'remove';
  removeButton.textContent = 'remove';
  var buttons = [{
    type: 'up',
    button: upButton
  }, {
    type: 'down',
    button: downButton
  }, {
    type: 'startOutOfTurn',
    button: startOutOfTurnButton
  }, {
    type: 'done',
    button: doneButton
  }, {
    type: 'undone',
    button: undoneButton
  }, {
    type: 'remove',
    button: removeButton
  }];
  var elements = {
    lists: document.querySelector('[data-container="lists"]'),
    listForm: document.querySelector('[data-container="new-list-form"]'),
    tasks: document.querySelector('[data-container="tasks"]'),
    doneTasks: document.querySelector('[data-container="done-tasks"]'),
    taskForm: document.querySelector('[data-container="new-task-form"]'),
    selectedTask: document.querySelector('[data-container="selected-task"]'),
    buttons: buttons
  };
  elements.listForm.addEventListener('submit', function (e) {
    e.preventDefault();
    var formData = new FormData(e.target);
    var value = formData.get('name');

    if (value !== '' && !state.lists[value]) {
      state.lists.push({
        id: _lodash["default"].uniqueId(),
        name: value,
        position: getPosition('list'),
        mutability: 'removeAble'
      });
    }

    state.render();
  });
  elements.taskForm.addEventListener('submit', function (e) {
    e.preventDefault();
    var formData = new FormData(e.target);
    var value = formData.get('name');

    if (value !== '' && !state.tasks[value]) {
      var task = {
        id: _lodash["default"].uniqueId(),
        parentList: state.activeList.name,
        name: value,
        position: getPosition('task'),
        isDone: false
      };
      state.tasks.push(task);
      state.render();
    }
  });
  state.mainState = mainState;

  state.render = function () {
    return render(elements);
  };

  var generalList = {
    id: _lodash["default"].uniqueId(),
    name: 'General',
    position: getPosition('list'),
    mutability: 'removeDisable'
  };
  state.lists.push(generalList);
  state.activeList = {
    id: generalList.id,
    name: generalList.name
  };
  state.render();
};

var completeTask = function completeTask() {
  var id = getSelectedElementId();
  if (id === null) return;
  var task = getElementById(id);
  task.isDone = !task.isDone;
  state.activeTaskId = null;
  state.render();
};

var _default = {
  init: init,
  completeTask: completeTask
};
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2pzU3JjL3NjcmlwdHMvVGFza01hbmFnZXIuanMiXSwibmFtZXMiOlsic3RhdGUiLCJhY3RpdmVMaXN0IiwiaWQiLCJuYW1lIiwiYWN0aXZlVGFza0lkIiwibGlzdHMiLCJ0YXNrcyIsImdldEVsZW1lbnRzSW4iLCJ0eXBlIiwiaXNEb25lIiwicmVzdWx0IiwiZmlsdGVyIiwidGFzayIsInBhcmVudExpc3QiLCJnZXRFbGVtZW50QnlJZCIsImZpbmQiLCJnZXRQb3NpdGlvbiIsImxlbmd0aCIsInNvcnRCeVBvc2l0aW9uIiwiYSIsImIiLCJwb3NpdGlvbiIsInNvcnRQb3NpdGlvbnNBZnRlclJlbW92ZSIsInNvcnRHcm91cCIsInNvcnQiLCJyZWR1Y2UiLCJhY2NJbmRleCIsImVsIiwiZXZlbnRGdW5jdGlvbnMiLCJzZWxlY3QiLCJ0YXJnZXQiLCJkYXRhc2V0IiwicmVuZGVyIiwiYnV0dG9ucyIsInJlcGxhY2UiLCJyZXBsYWNlVHlwZSIsImJ1dHRvbkZ1bmMiLCJwYXJlbnROb2RlIiwidXBEb3duUG9zIiwibWFpbkVsZW1lbnQiLCJzZWNvbmRhcnlFbGVtZW50IiwiY29uc29sZSIsImxvZyIsInN0YXJ0T3V0T2ZUdXJuIiwibWFpblN0YXRlIiwic2V0RGVmYXVsdCIsImRvbmVVbmRvbmUiLCJyZW1vdmUiLCJhcmVhTmFtZSIsImdldFNlbGVjdGVkRWxlbWVudElkIiwibmV4dEVsZW1lbnQiLCJzZWxlY3RCdXR0b25zIiwibGlzdCIsInJlbW92ZUFibGUiLCJyZW1vdmVEaXNhYmxlIiwiZG9uZVRhc2siLCJlbGVtZW50cyIsInVsRm9yTGlzdHMiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJmb3JFYWNoIiwibXV0YWJpbGl0eSIsImxpIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJhZGRFdmVudExpc3RlbmVyIiwibGlCdXR0b25zIiwiaW5jbHVkZXMiLCJtYXAiLCJidXR0b24iLCJjbG9uZU5vZGUiLCJidXR0b25UeXBlIiwiYXBwZW5kIiwiYXBwZW5kQ2hpbGQiLCJpbm5lckhUTUwiLCJ1bEZvclRhc2tzIiwidWxGb3JEb25lVGFza3MiLCJkb25lVGFza3MiLCJsaXN0Rm9ybSIsInJlc2V0IiwidGFza0Zvcm0iLCJpbml0IiwidXBCdXR0b24iLCJkb3duQnV0dG9uIiwic3RhcnRPdXRPZlR1cm5CdXR0b24iLCJkb25lQnV0dG9uIiwidW5kb25lQnV0dG9uIiwicmVtb3ZlQnV0dG9uIiwicXVlcnlTZWxlY3RvciIsInNlbGVjdGVkVGFzayIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImZvcm1EYXRhIiwiRm9ybURhdGEiLCJ2YWx1ZSIsImdldCIsInB1c2giLCJfIiwidW5pcXVlSWQiLCJnZW5lcmFsTGlzdCIsImNvbXBsZXRlVGFzayJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUVBOzs7Ozs7Ozs7Ozs7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBRUEsSUFBTUEsS0FBSyxHQUFHO0FBQ1pDLEVBQUFBLFVBQVUsRUFBRTtBQUNWQyxJQUFBQSxFQUFFLEVBQUUsSUFETTtBQUVWQyxJQUFBQSxJQUFJLEVBQUU7QUFGSSxHQURBO0FBS1pDLEVBQUFBLFlBQVksRUFBRSxJQUxGO0FBTVpDLEVBQUFBLEtBQUssRUFBRSxFQU5LO0FBT1pDLEVBQUFBLEtBQUssRUFBRTtBQVBLLENBQWQ7O0FBVUEsSUFBTUMsYUFBYSxHQUFHLFNBQWhCQSxhQUFnQixDQUFDQyxJQUFELEVBQTBCO0FBQUEsTUFBbkJDLE1BQW1CLHVFQUFWLEtBQVU7QUFDOUMsTUFBTUMsTUFBTSxHQUFJRixJQUFJLEtBQUssTUFBVCxHQUFrQlIsS0FBSyxDQUFDSyxLQUF4QixHQUFpQ0wsS0FBSyxDQUFDTSxLQUFOLENBQzlDSyxNQUQ4QyxDQUN2QyxVQUFDQyxJQUFEO0FBQUEsV0FBV0EsSUFBSSxDQUFDQyxVQUFMLEtBQW9CYixLQUFLLENBQUNDLFVBQU4sQ0FBaUJFLElBQXJDLElBQTZDUyxJQUFJLENBQUNILE1BQUwsS0FBZ0JBLE1BQXhFO0FBQUEsR0FEdUMsQ0FBakQ7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R2xCa0IsSUFBQUEsUUFBUSxFQUFFTCxXQUFXLENBQUMsTUFBRCxDQUhIO0FBSWxCNkMsSUFBQUEsVUFBVSxFQUFFO0FBSk0sR0FBcEI7QUFNQTdELEVBQUFBLEtBQUssQ0FBQ0ssS0FBTixDQUFZNEYsSUFBWixDQUFpQkcsV0FBakI7QUFDQXBHLEVBQUFBLEtBQUssQ0FBQ0MsVUFBTixHQUFtQjtBQUFFQyxJQUFBQSxFQUFFLEVBQUVrRyxXQUFXLENBQUNsRyxFQUFsQjtBQUFzQkMsSUFBQUEsSUFBSSxFQUFFaUcsV0FBVyxDQUFDakc7QUFBeEMsR0FBbkI7QUFDQUgsRUFBQUEsS0FBSyxDQUFDZ0MsTUFBTjtBQUNELENBckZEOztBQXVGQSxJQUFNcUUsWUFBWSxHQUFHLFNBQWZBLFlBQWUsR0FBTTtBQUN6QixNQUFNbkcsRUFBRSxHQUFHK0Msb0JBQW9CLEVBQS9CO0FBQ0EsTUFBSS9DLEVBQUUsS0FBSyxJQUFYLEVBQWlCO0FBQ2pCLE1BQU1VLElBQUksR0FBR0UsY0FBYyxDQUFDWixFQUFELENBQTNCO0FBQ0FVLEVBQUFBLElBQUksQ0FBQ0gsTUFBTCxHQUFjLENBQUNHLElBQUksQ0FBQ0gsTUFBcEI7QUFDQVQsRUFBQUEsS0FBSyxDQUFDSSxZQUFOLEdBQXFCLElBQXJCO0FBQ0FKLEVBQUFBLEtBQUssQ0FBQ2dDLE1BQU47QUFDRCxDQVBEOztlQVNlO0FBQUVrRCxFQUFBQSxJQUFJLEVBQUpBLElBQUY7QUFBUW1CLEVBQUFBLFlBQVksRUFBWkE7QUFBUixDIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgbm8tY29uc29sZSAqL1xyXG5cclxuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcclxuLy8gaW1wb3J0IFdhdGNoSlMgZnJvbSAnd2F0Y2hqcyc7XHJcbi8vXHJcbi8vIGNvbnN0IHsgd2F0Y2ggfSA9IFdhdGNoSlM7XHJcblxyXG5jb25zdCBzdGF0ZSA9IHtcclxuICBhY3RpdmVMaXN0OiB7XHJcbiAgICBpZDogbnVsbCxcclxuICAgIG5hbWU6ICcnLFxyXG4gIH0sXHJcbiAgYWN0aXZlVGFza0lkOiBudWxsLFxyXG4gIGxpc3RzOiBbXSxcclxuICB0YXNrczogW10sXHJcbn07XHJcblxyXG5jb25zdCBnZXRFbGVtZW50c0luID0gKHR5cGUsIGlzRG9uZSA9IGZhbHNlKSA9PiB7XHJcbiAgY29uc3QgcmVzdWx0ID0gKHR5cGUgPT09ICdsaXN0JyA/IHN0YXRlLmxpc3RzIDogKHN0YXRlLnRhc2tzXHJcbiAgICAuZmlsdGVyKCh0YXNrKSA9PiAodGFzay5wYXJlbnRMaXN0ID09PSBzdGF0ZS5hY3RpdmVMaXN0Lm5hbWUgJiYgdGFzay5pc0RvbmUgPT09IGlzRG9uZSkpXHJcbiAgKSk7XHJcbiAgcmV0dXJuIHJlc3VsdDtcclxufTtcclxuXHJcbmNvbnN0IGdldEVsZW1lbnRCeUlkID0gKGlkLCB0eXBlID0gJ3Rhc2snKSA9PiAoXHJcbiAgWy4uLmdldEVsZW1lbnRzSW4odHlwZSksIC4uLmdldEVsZW1lbnRzSW4odHlwZSwgdHJ1ZSldLmZpbmQoKHRhc2spID0+IHRhc2suaWQgPT09IGlkKVxyXG4pO1xyXG5cclxuY29uc3QgZ2V0UG9zaXRpb24gPSAodHlwZSwgaXNEb25lID0gZmFsc2UpID0+IGdldEVsZW1lbnRzSW4odHlwZSwgaXNEb25lKS5sZW5ndGg7XHJcblxyXG5jb25zdCBzb3J0QnlQb3NpdGlvbiA9IChhLCBiKSA9PiBhLnBvc2l0aW9uIC0gYi5wb3NpdGlvbjtcclxuXHJcbmNvbnN0IHNvcnRQb3NpdGlvbnNBZnRlclJlbW92ZSA9ICh0eXBlLCBpc0RvbmUpID0+IHtcclxuICBjb25zdCBzb3J0R3JvdXAgPSBnZXRFbGVtZW50c0luKHR5cGUsIGlzRG9uZSk7XHJcbiAgc29ydEdyb3VwLnNvcnQoc29ydEJ5UG9zaXRpb24pXHJcbiAgICAucmVkdWNlKChhY2NJbmRleCwgZWwpID0+IHtcclxuICAgICAgZWwucG9zaXRpb24gPSBhY2NJbmRleDtcclxuICAgICAgcmV0dXJuIGFjY0luZGV4ICsgMTtcclxuICAgIH0sIDApO1xyXG59O1xyXG5cclxuY29uc3QgZXZlbnRGdW5jdGlvbnMgPSB7XHJcbiAgbGlzdHM6IHtcclxuICAgIHNlbGVjdDogKHsgdGFyZ2V0IH0pID0+IHtcclxuICAgICAgY29uc3QgeyBpZCwgbmFtZSB9ID0gdGFyZ2V0LmRhdGFzZXQ7XHJcbiAgICAgIHN0YXRlLmFjdGl2ZUxpc3QgPSB7IGlkLCBuYW1lIH07XHJcbiAgICAgIHN0YXRlLnJlbmRlcigpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIGJ1dHRvbnM6IHtcclxuICAgIHJlcGxhY2U6ICh7IHRhcmdldCB9KSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlcGxhY2VUeXBlID0gdGFyZ2V0LmRhdGFzZXQuYnV0dG9uRnVuYztcclxuICAgICAgY29uc3QgeyB0eXBlLCBpZCB9ID0gdGFyZ2V0LnBhcmVudE5vZGUuZGF0YXNldDtcclxuICAgICAgY29uc3QgdXBEb3duUG9zID0gKHJlcGxhY2VUeXBlID09PSAndXAnID8gLTEgOiAxKTtcclxuICAgICAgY29uc3QgbWFpbkVsZW1lbnQgPSBnZXRFbGVtZW50QnlJZChpZCwgdHlwZSk7XHJcbiAgICAgIGNvbnN0IHNlY29uZGFyeUVsZW1lbnQgPSBnZXRFbGVtZW50c0luKHR5cGUpLmZpbmQoKHRhc2spID0+IChcclxuICAgICAgICB0YXNrLnBvc2l0aW9uID09PSBtYWluRWxlbWVudC5wb3NpdGlvbiArIHVwRG93blBvc1xyXG4gICAgICApKTtcclxuICAgICAgY29uc29sZS5sb2coJ3JlcGxhY2UnLCBtYWluRWxlbWVudCwgc2Vjb25kYXJ5RWxlbWVudCwgdXBEb3duUG9zLCByZXBsYWNlVHlwZSwgdHlwZSwgaWQpXHJcbiAgICAgIGlmICghc2Vjb25kYXJ5RWxlbWVudCkgcmV0dXJuO1xyXG4gICAgICBtYWluRWxlbWVudC5wb3NpdGlvbiArPSB1cERvd25Qb3M7XHJcbiAgICAgIHNlY29uZGFyeUVsZW1lbnQucG9zaXRpb24gLT0gdXBEb3duUG9zO1xyXG4gICAgICBzdGF0ZS5yZW5kZXIoKTtcclxuICAgIH0sXHJcbiAgICBzdGFydE91dE9mVHVybjogKHsgdGFyZ2V0IH0pID0+IHtcclxuICAgICAgY29uc3QgeyBpZCB9ID0gdGFyZ2V0LnBhcmVudE5vZGUuZGF0YXNldDtcclxuICAgICAgc3RhdGUuYWN0aXZlVGFza0lkID0gaWQ7XHJcbiAgICAgIHN0YXRlLm1haW5TdGF0ZS5zZXREZWZhdWx0KGZhbHNlKTtcclxuICAgICAgc3RhdGUucmVuZGVyKCk7XHJcbiAgICB9LFxyXG4gICAgZG9uZVVuZG9uZTogKHsgdGFyZ2V0IH0pID0+IHtcclxuICAgICAgY29uc3QgeyB0eXBlLCBpZCB9ID0gdGFyZ2V0LnBhcmVudE5vZGUuZGF0YXNldDtcclxuICAgICAgY29uc3QgdGFzayA9IGdldEVsZW1lbnRCeUlkKGlkKTtcclxuICAgICAgdGFzay5pc0RvbmUgPSAhdGFzay5pc0RvbmU7XHJcbiAgICAgIHRhc2sucG9zaXRpb24gPSBnZXRQb3NpdGlvbih0eXBlLCB0YXNrLmlzRG9uZSk7XHJcbiAgICAgIHNvcnRQb3NpdGlvbnNBZnRlclJlbW92ZSh0eXBlLCBmYWxzZSk7XHJcbiAgICAgIHNvcnRQb3NpdGlvbnNBZnRlclJlbW92ZSh0eXBlLCB0cnVlKTtcclxuICAgICAgc3RhdGUucmVuZGVyKCk7XHJcbiAgICB9LFxyXG4gICAgcmVtb3ZlOiAoeyB0YXJnZXQgfSkgPT4ge1xyXG4gICAgICBjb25zdCB7IHR5cGUsIGlkIH0gPSB0YXJnZXQucGFyZW50Tm9kZS5kYXRhc2V0O1xyXG4gICAgICBjb25zdCBpc0RvbmUgPSBnZXRFbGVtZW50QnlJZChpZCwgdHlwZSkuaXNEb25lO1xyXG4gICAgICBjb25zdCBhcmVhTmFtZSA9IGAke3R5cGV9c2A7XHJcbiAgICAgIHN0YXRlW2FyZWFOYW1lXSA9IHN0YXRlW2FyZWFOYW1lXS5maWx0ZXIoKGVsKSA9PiBlbC5pZCAhPT0gaWQpO1xyXG4gICAgICBzb3J0UG9zaXRpb25zQWZ0ZXJSZW1vdmUodHlwZSwgaXNEb25lKTtcclxuICAgICAgc3RhdGUucmVuZGVyKCk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbn07XHJcblxyXG5jb25zdCBnZXRTZWxlY3RlZEVsZW1lbnRJZCA9ICgpID0+IHtcclxuICBpZiAoc3RhdGUuYWN0aXZlVGFza0lkICE9PSBudWxsKSByZXR1cm4gc3RhdGUuYWN0aXZlVGFza0lkO1xyXG4gIGNvbnN0IG5leHRFbGVtZW50ID0gZ2V0RWxlbWVudHNJbigndGFzaycpLnNvcnQoc29ydEJ5UG9zaXRpb24pWzBdO1xyXG4gIHJldHVybiAobmV4dEVsZW1lbnQgPyBuZXh0RWxlbWVudC5pZCA6IG51bGwpO1xyXG59O1xyXG5cclxuY29uc3Qgc2VsZWN0QnV0dG9ucyA9IHtcclxuICBsaXN0OiB7XHJcbiAgICByZW1vdmVBYmxlOiBbJ3VwJywgJ2Rvd24nLCAncmVtb3ZlJ10sXHJcbiAgICByZW1vdmVEaXNhYmxlOiBbJ3VwJywgJ2Rvd24nXSxcclxuICB9LFxyXG4gIHRhc2s6IFsndXAnLCAnZG93bicsICdzdGFydE91dE9mVHVybicsICdkb25lJywgJ3JlbW92ZSddLFxyXG4gIGRvbmVUYXNrOiBbJ3VuZG9uZScsICdyZW1vdmUnXSxcclxufTtcclxuXHJcbmNvbnN0IHJlbmRlciA9IChlbGVtZW50cykgPT4ge1xyXG4gIGNvbnN0IHVsRm9yTGlzdHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xyXG4gIHN0YXRlLmxpc3RzLnNvcnQoc29ydEJ5UG9zaXRpb24pXHJcbiAgICAuZm9yRWFjaCgoeyBpZCwgbmFtZSwgbXV0YWJpbGl0eSB9KSA9PiB7XHJcbiAgICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICAgICAgbGkuZGF0YXNldC50eXBlID0gJ2xpc3QnO1xyXG4gICAgICBsaS5kYXRhc2V0LmlkID0gaWQ7XHJcbiAgICAgIGxpLmRhdGFzZXQubmFtZSA9IG5hbWU7XHJcbiAgICAgIGlmIChpZCA9PT0gc3RhdGUuYWN0aXZlTGlzdC5pZCkgbGkuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcclxuICAgICAgbGkudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICBsaS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2ZW50RnVuY3Rpb25zLmxpc3RzLnNlbGVjdCk7XHJcbiAgICAgIGNvbnN0IGxpQnV0dG9ucyA9IGVsZW1lbnRzLmJ1dHRvbnMuZmlsdGVyKCh7IHR5cGUgfSkgPT4gc2VsZWN0QnV0dG9ucy5saXN0W211dGFiaWxpdHldLmluY2x1ZGVzKHR5cGUpKVxyXG4gICAgICAgIC5tYXAoKHsgYnV0dG9uIH0pID0+IGJ1dHRvbi5jbG9uZU5vZGUodHJ1ZSkpXHJcbiAgICAgICAgLm1hcCgoYnV0dG9uKSA9PiB7XHJcbiAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldmVudEZ1bmN0aW9ucy5idXR0b25zW2J1dHRvbi5kYXRhc2V0LmJ1dHRvblR5cGVdKTtcclxuICAgICAgICAgIHJldHVybiBidXR0b247XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIGxpLmFwcGVuZCguLi5saUJ1dHRvbnMpO1xyXG4gICAgICB1bEZvckxpc3RzLmFwcGVuZENoaWxkKGxpKTtcclxuICAgIH0pO1xyXG4gIGVsZW1lbnRzLmxpc3RzLmlubmVySFRNTCA9ICcnO1xyXG4gIGVsZW1lbnRzLmxpc3RzLmFwcGVuZENoaWxkKHVsRm9yTGlzdHMpO1xyXG5cclxuICBjb25zdCB1bEZvclRhc2tzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTtcclxuICBnZXRFbGVtZW50c0luKCd0YXNrJywgZmFsc2UpLnNvcnQoc29ydEJ5UG9zaXRpb24pXHJcbiAgICAuZm9yRWFjaCgoeyBpZCwgbmFtZSB9KSA9PiB7XHJcbiAgICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICAgICAgbGkuZGF0YXNldC5pZCA9IGlkO1xyXG4gICAgICBpZiAoaWQgPT09IGdldFNlbGVjdGVkRWxlbWVudElkKCkpIGxpLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XHJcbiAgICAgIGxpLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgbGkuZGF0YXNldC50eXBlID0gJ3Rhc2snO1xyXG4gICAgICBjb25zdCBsaUJ1dHRvbnMgPSBlbGVtZW50cy5idXR0b25zLmZpbHRlcigoeyB0eXBlIH0pID0+IHNlbGVjdEJ1dHRvbnMudGFzay5pbmNsdWRlcyh0eXBlKSlcclxuICAgICAgICAubWFwKCh7IGJ1dHRvbiB9KSA9PiBidXR0b24uY2xvbmVOb2RlKHRydWUpKVxyXG4gICAgICAgIC5tYXAoKGJ1dHRvbikgPT4ge1xyXG4gICAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZlbnRGdW5jdGlvbnMuYnV0dG9uc1tidXR0b24uZGF0YXNldC5idXR0b25UeXBlXSk7XHJcbiAgICAgICAgICByZXR1cm4gYnV0dG9uO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICBsaS5hcHBlbmQoLi4ubGlCdXR0b25zKTtcclxuICAgICAgdWxGb3JUYXNrcy5hcHBlbmRDaGlsZChsaSk7XHJcbiAgICB9KTtcclxuICBlbGVtZW50cy50YXNrcy5pbm5lckhUTUwgPSAnJztcclxuICBlbGVtZW50cy50YXNrcy5hcHBlbmRDaGlsZCh1bEZvclRhc2tzKTtcclxuXHJcbiAgY29uc3QgdWxGb3JEb25lVGFza3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd1bCcpO1xyXG4gIGdldEVsZW1lbnRzSW4oJ3Rhc2snLCB0cnVlKS5zb3J0KHNvcnRCeVBvc2l0aW9uKVxyXG4gICAgLmZvckVhY2goKHsgaWQsIG5hbWUgfSkgPT4ge1xyXG4gICAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgICAgIGxpLmRhdGFzZXQuaWQgPSBpZDtcclxuICAgICAgbGkudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICBsaS5kYXRhc2V0LnR5cGUgPSAnZG9uZVRhc2snO1xyXG4gICAgICBjb25zdCBsaUJ1dHRvbnMgPSBlbGVtZW50cy5idXR0b25zLmZpbHRlcigoeyB0eXBlIH0pID0+IHNlbGVjdEJ1dHRvbnMuZG9uZVRhc2suaW5jbHVkZXModHlwZSkpXHJcbiAgICAgICAgLm1hcCgoeyBidXR0b24gfSkgPT4gYnV0dG9uLmNsb25lTm9kZSh0cnVlKSlcclxuICAgICAgICAubWFwKChidXR0b24pID0+IHtcclxuICAgICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2ZW50RnVuY3Rpb25zLmJ1dHRvbnNbYnV0dG9uLmRhdGFzZXQuYnV0dG9uVHlwZV0pO1xyXG4gICAgICAgICAgcmV0dXJuIGJ1dHRvbjtcclxuICAgICAgICB9KTtcclxuICAgICAgbGkuYXBwZW5kKC4uLmxpQnV0dG9ucyk7XHJcbiAgICAgIHVsRm9yRG9uZVRhc2tzLmFwcGVuZENoaWxkKGxpKTtcclxuICAgIH0pO1xyXG4gIGVsZW1lbnRzLmRvbmVUYXNrcy5pbm5lckhUTUwgPSAnJztcclxuICBlbGVtZW50cy5kb25lVGFza3MuYXBwZW5kQ2hpbGQodWxGb3JEb25lVGFza3MpO1xyXG5cclxuICBlbGVtZW50cy5saXN0Rm9ybS5yZXNldCgpO1xyXG4gIGVsZW1lbnRzLnRhc2tGb3JtLnJlc2V0KCk7XHJcbn07XHJcblxyXG5jb25zdCBpbml0ID0gKG1haW5TdGF0ZSkgPT4ge1xyXG4gIGNvbnN0IHVwQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgdXBCdXR0b24uZGF0YXNldC5idXR0b25UeXBlID0gJ3JlcGxhY2UnO1xyXG4gIHVwQnV0dG9uLmRhdGFzZXQuYnV0dG9uRnVuYyA9ICd1cCc7XHJcbiAgdXBCdXR0b24udGV4dENvbnRlbnQgPSAndXAnO1xyXG4gIGNvbnN0IGRvd25CdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICBkb3duQnV0dG9uLmRhdGFzZXQuYnV0dG9uVHlwZSA9ICdyZXBsYWNlJztcclxuICBkb3duQnV0dG9uLmRhdGFzZXQuYnV0dG9uRnVuYyA9ICdkb3duJztcclxuICBkb3duQnV0dG9uLnRleHRDb250ZW50ID0gJ2Rvd24nO1xyXG4gIGNvbnN0IHN0YXJ0T3V0T2ZUdXJuQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgc3RhcnRPdXRPZlR1cm5CdXR0b24uZGF0YXNldC5idXR0b25UeXBlID0gJ3N0YXJ0T3V0T2ZUdXJuJztcclxuICBzdGFydE91dE9mVHVybkJ1dHRvbi50ZXh0Q29udGVudCA9ICdzdGFydCBub3cnO1xyXG4gIGNvbnN0IGRvbmVCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICBkb25lQnV0dG9uLmRhdGFzZXQuYnV0dG9uVHlwZSA9ICdkb25lVW5kb25lJztcclxuICBkb25lQnV0dG9uLnRleHRDb250ZW50ID0gJ2RvbmUnO1xyXG4gIGNvbnN0IHVuZG9uZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gIHVuZG9uZUJ1dHRvbi5kYXRhc2V0LmJ1dHRvblR5cGUgPSAnZG9uZVVuZG9uZSc7XHJcbiAgdW5kb25lQnV0dG9uLnRleHRDb250ZW50ID0gJ3VuZG9uZSc7XHJcbiAgY29uc3QgcmVtb3ZlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgcmVtb3ZlQnV0dG9uLmRhdGFzZXQuYnV0dG9uVHlwZSA9ICdyZW1vdmUnO1xyXG4gIHJlbW92ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICdyZW1vdmUnO1xyXG5cclxuICBjb25zdCBidXR0b25zID0gW1xyXG4gICAgeyB0eXBlOiAndXAnLCBidXR0b246IHVwQnV0dG9uIH0sXHJcbiAgICB7IHR5cGU6ICdkb3duJywgYnV0dG9uOiBkb3duQnV0dG9uIH0sXHJcbiAgICB7IHR5cGU6ICdzdGFydE91dE9mVHVybicsIGJ1dHRvbjogc3RhcnRPdXRPZlR1cm5CdXR0b24gfSxcclxuICAgIHsgdHlwZTogJ2RvbmUnLCBidXR0b246IGRvbmVCdXR0b24gfSxcclxuICAgIHsgdHlwZTogJ3VuZG9uZScsIGJ1dHRvbjogdW5kb25lQnV0dG9uIH0sXHJcbiAgICB7IHR5cGU6ICdyZW1vdmUnLCBidXR0b246IHJlbW92ZUJ1dHRvbiB9LFxyXG4gIF07XHJcblxyXG4gIGNvbnN0IGVsZW1lbnRzID0ge1xyXG4gICAgbGlzdHM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWNvbnRhaW5lcj1cImxpc3RzXCJdJyksXHJcbiAgICBsaXN0Rm9ybTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtY29udGFpbmVyPVwibmV3LWxpc3QtZm9ybVwiXScpLFxyXG4gICAgdGFza3M6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWNvbnRhaW5lcj1cInRhc2tzXCJdJyksXHJcbiAgICBkb25lVGFza3M6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWNvbnRhaW5lcj1cImRvbmUtdGFza3NcIl0nKSxcclxuICAgIHRhc2tGb3JtOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1jb250YWluZXI9XCJuZXctdGFzay1mb3JtXCJdJyksXHJcbiAgICBzZWxlY3RlZFRhc2s6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWNvbnRhaW5lcj1cInNlbGVjdGVkLXRhc2tcIl0nKSxcclxuICAgIGJ1dHRvbnMsXHJcbiAgfTtcclxuXHJcbiAgZWxlbWVudHMubGlzdEZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGUudGFyZ2V0KTtcclxuICAgIGNvbnN0IHZhbHVlID0gZm9ybURhdGEuZ2V0KCduYW1lJyk7XHJcbiAgICBpZiAodmFsdWUgIT09ICcnICYmICFzdGF0ZS5saXN0c1t2YWx1ZV0pIHtcclxuICAgICAgc3RhdGUubGlzdHMucHVzaCh7XHJcbiAgICAgICAgaWQ6IF8udW5pcXVlSWQoKSxcclxuICAgICAgICBuYW1lOiB2YWx1ZSxcclxuICAgICAgICBwb3NpdGlvbjogZ2V0UG9zaXRpb24oJ2xpc3QnKSxcclxuICAgICAgICBtdXRhYmlsaXR5OiAncmVtb3ZlQWJsZScsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgc3RhdGUucmVuZGVyKCk7XHJcbiAgfSk7XHJcblxyXG4gIGVsZW1lbnRzLnRhc2tGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YShlLnRhcmdldCk7XHJcbiAgICBjb25zdCB2YWx1ZSA9IGZvcm1EYXRhLmdldCgnbmFtZScpO1xyXG4gICAgaWYgKHZhbHVlICE9PSAnJyAmJiAhc3RhdGUudGFza3NbdmFsdWVdKSB7XHJcbiAgICAgIGNvbnN0IHRhc2sgPSB7XHJcbiAgICAgICAgaWQ6IF8udW5pcXVlSWQoKSxcclxuICAgICAgICBwYXJlbnRMaXN0OiBzdGF0ZS5hY3RpdmVMaXN0Lm5hbWUsXHJcbiAgICAgICAgbmFtZTogdmFsdWUsXHJcbiAgICAgICAgcG9zaXRpb246IGdldFBvc2l0aW9uKCd0YXNrJyksXHJcbiAgICAgICAgaXNEb25lOiBmYWxzZSxcclxuICAgICAgfTtcclxuICAgICAgc3RhdGUudGFza3MucHVzaCh0YXNrKTtcclxuICAgICAgc3RhdGUucmVuZGVyKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIHN0YXRlLm1haW5TdGF0ZSA9IG1haW5TdGF0ZTtcclxuICBzdGF0ZS5yZW5kZXIgPSAoKSA9PiByZW5kZXIoZWxlbWVudHMpO1xyXG5cclxuICBjb25zdCBnZW5lcmFsTGlzdCA9IHtcclxuICAgIGlkOiBfLnVuaXF1ZUlkKCksXHJcbiAgICBuYW1lOiAnR2VuZXJhbCcsXHJcbiAgICBwb3NpdGlvbjogZ2V0UG9zaXRpb24oJ2xpc3QnKSxcclxuICAgIG11dGFiaWxpdHk6ICdyZW1vdmVEaXNhYmxlJyxcclxuICB9O1xyXG4gIHN0YXRlLmxpc3RzLnB1c2goZ2VuZXJhbExpc3QpO1xyXG4gIHN0YXRlLmFjdGl2ZUxpc3QgPSB7IGlkOiBnZW5lcmFsTGlzdC5pZCwgbmFtZTogZ2VuZXJhbExpc3QubmFtZSB9O1xyXG4gIHN0YXRlLnJlbmRlcigpO1xyXG59O1xyXG5cclxuY29uc3QgY29tcGxldGVUYXNrID0gKCkgPT4ge1xyXG4gIGNvbnN0IGlkID0gZ2V0U2VsZWN0ZWRFbGVtZW50SWQoKTtcclxuICBpZiAoaWQgPT09IG51bGwpIHJldHVybjtcclxuICBjb25zdCB0YXNrID0gZ2V0RWxlbWVudEJ5SWQoaWQpO1xyXG4gIHRhc2suaXNEb25lID0gIXRhc2suaXNEb25lO1xyXG4gIHN0YXRlLmFjdGl2ZVRhc2tJZCA9IG51bGw7XHJcbiAgc3RhdGUucmVuZGVyKCk7XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCB7IGluaXQsIGNvbXBsZXRlVGFzayB9O1xyXG4iXX0=